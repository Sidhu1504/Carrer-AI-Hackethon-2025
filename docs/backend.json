{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CareerCraft AI application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user.",
          "format": "uuid"
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "createdAt"
      ]
    },
    "ResumeAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResumeAnalysis",
      "type": "object",
      "description": "Stores the results of a resume analysis performed by the AI.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resume analysis record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who uploaded the resume. (Relationship: User 1:N ResumeAnalysis)"
        },
        "resumeText": {
          "type": "string",
          "description": "The extracted text content from the uploaded resume."
        },
        "atsScore": {
          "type": "number",
          "description": "The ATS score generated by the AI for the resume."
        },
        "improvementTips": {
          "type": "string",
          "description": "AI-generated tips for improving the resume (e.g., formatting, content)."
        },
        "skillGapLearningPlan": {
          "type": "string",
          "description": "A personalized 4-week learning plan for missing skills identified in the resume."
        },
        "analysisDate": {
          "type": "string",
          "description": "Timestamp indicating when the resume analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "resumeText",
        "atsScore",
        "improvementTips",
        "skillGapLearningPlan",
        "analysisDate"
      ]
    },
    "MockInterview": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MockInterview",
      "type": "object",
      "description": "Represents a mock interview session and its results.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the mock interview session."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who participated in the mock interview. (Relationship: User 1:N MockInterview)"
        },
        "profession": {
          "type": "string",
          "description": "The profession selected for the mock interview (e.g., Software Engineer, Data Scientist)."
        },
        "interviewQuestions": {
          "type": "string",
          "description": "The interview questions that where asked to the user.",
          "format": "json"
        },
        "answers": {
          "type": "string",
          "description": "The answers given by the user.",
          "format": "json"
        },
        "feedback": {
          "type": "string",
          "description": "AI-generated feedback on the user's answers.",
          "format": "json"
        },
        "score": {
          "type": "number",
          "description": "Overall score for the mock interview session."
        },
        "interviewDate": {
          "type": "string",
          "description": "Timestamp indicating when the mock interview took place.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "profession",
        "interviewQuestions",
        "answers",
        "feedback",
        "score",
        "interviewDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information.  Authorization is based on matching {userId} with request.auth.uid.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumeAnalyses/{resumeAnalysisId}",
        "definition": {
          "entityName": "ResumeAnalysis",
          "schema": {
            "$ref": "#/backend/entities/ResumeAnalysis"
          },
          "description": "Stores resume analysis results for a specific user. Authorization is based on path-based ownership: request.auth.uid must match the {userId}.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who owns the resume analysis."
            },
            {
              "name": "resumeAnalysisId",
              "description": "The unique identifier for the resume analysis record."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/mockInterviews/{mockInterviewId}",
        "definition": {
          "entityName": "MockInterview",
          "schema": {
            "$ref": "#/backend/entities/MockInterview"
          },
          "description": "Stores mock interview records for a specific user. Authorization is based on path-based ownership: request.auth.uid must match the {userId}.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who participated in the mock interview."
            },
            {
              "name": "mockInterviewId",
              "description": "The unique identifier for the mock interview session."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to store user data, resume analysis results, and mock interview records.  The structure prioritizes authorization independence to ensure secure and scalable operations. User data, resume analyses, and mock interview records are stored in separate collections under the `/users/{userId}` path, ensuring path-based ownership. This approach simplifies security rules, eliminating the need for complex `get()` calls and facilitating atomic operations.\n\nAuthorization Independence: Achieved through path-based ownership. Each user's data is stored under their respective `userId`, allowing for simple security rules based on `request.auth.uid == userId`.\n\nQAPs Support:\n\n*   List operations for ResumeAnalysis and MockInterview are secured by path-based ownership. A user can only list data under their `/users/{userId}` path.\n\nHomogeneous Security Posture: All documents within each subcollection (resumeAnalyses, mockInterviews) share the same security requirements, further simplifying rules."
  }
}